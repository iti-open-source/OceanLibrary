<div
  class="min-h-screen"
  style="background-color: var(--color-background-light)"
>
  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center min-h-screen">
    <div class="text-center">
      <div
        class="animate-spin rounded-full h-16 w-16 border-b-2 mx-auto mb-4 loading-spinner"
        style="border-color: var(--color-brand-primary)"
      ></div>
      <p class="text-lg" style="color: var(--color-text-muted)">
        Discovering amazing books...
      </p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="container mx-auto px-4 py-12">
    <div
      class="border rounded-xl p-8 text-center"
      style="
        background-color: var(--color-background-medium);
        border-color: var(--color-border);
      "
    >
      <lucide-angular
        [img]="BookOpen"
        class="h-12 w-12 mx-auto mb-4"
        style="color: var(--color-brand-primary)"
      ></lucide-angular>
      <h2
        class="text-xl font-semibold mb-2"
        style="color: var(--color-text-heading)"
      >
        Oops! Something went wrong
      </h2>
      <p class="mb-4" style="color: var(--color-text-muted)">
        {{ errorMessage }}
      </p>
      <button
        (click)="loadHomeData()"
        class="px-6 py-2 rounded-lg transition-colors"
        style="
          background-color: var(--color-brand-primary);
          color: var(--color-on-dark);
        "
        onmouseover="this.style.opacity='0.8'"
        onmouseout="this.style.opacity='1'"
      >
        Try Again
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading && !errorMessage">
    <!-- Minimalist Hero Section -->
    <section class="py-24 hero-minimal">
      <div class="container mx-auto px-4 text-center">
        <div class="max-w-4xl mx-auto">
          <h1
            class="text-5xl md:text-7xl font-bold mb-8 tracking-tight hero-title"
            style="
              color: var(--color-text-heading);
              font-family: var(--font-primary);
            "
          >
            Ocean Library
          </h1>
          <p
            class="text-xl md:text-2xl mb-12 font-light leading-relaxed hero-subtitle"
            style="color: var(--color-text-muted)"
          >
            Curated books for curious minds
          </p>
          <div class="flex justify-center gap-6">
            <button
              [routerLink]="['/browse']"
              class="px-8 py-4 border-2 rounded-full font-medium text-lg transition-all duration-300 hover-border-button"
              style="border-color: var(--color-text-heading)"
            >
              Browse Collection
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Featured Book Spotlight -->
    <section
      *ngIf="featuredBooks.length > 0"
      class="py-20"
      style="background-color: var(--color-background-medium)"
    >
      <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
          <div class="grid lg:grid-cols-2 gap-16 items-center">
            <!-- Left: Large Featured Book -->
            <div
              class="relative group cursor-pointer"
              [routerLink]="['/book-info', featuredBooks[0]._id]"
            >
              <div
                class="aspect-[3/4] max-w-md mx-auto overflow-hidden rounded-3xl shadow-2xl"
              >
                <img
                  [src]="featuredBooks[0].image"
                  [alt]="featuredBooks[0].title"
                  class="w-full h-full object-cover transform transition-all duration-700 group-hover:scale-105"
                />
              </div>
              <div
                class="absolute -bottom-8 -right-8 w-24 h-24 rounded-full flex items-center justify-center shadow-lg featured-badge"
                style="background-color: var(--color-brand-primary)"
              >
                <lucide-angular
                  [img]="Crown"
                  class="w-8 h-8"
                  style="color: var(--color-on-dark)"
                ></lucide-angular>
              </div>
            </div>

            <!-- Right: Featured Book Info -->
            <div class="space-y-8">
              <div>
                <span
                  class="text-sm font-medium tracking-wide uppercase mb-4 block"
                  style="color: var(--color-brand-primary)"
                  >Featured Book</span
                >
                <h2
                  class="text-4xl md:text-5xl font-bold mb-4 leading-tight"
                  style="
                    color: var(--color-text-heading);
                    font-family: var(--font-primary);
                  "
                >
                  {{ featuredBooks[0].title }}
                </h2>
                <p class="text-xl mb-6" style="color: var(--color-text-muted)">
                  by {{ featuredBooks[0].authorName }}
                </p>
                <div class="flex items-center gap-6 mb-8">
                  <div class="flex items-center gap-2">
                    <div class="flex" style="color: #fbbf24">
                      <lucide-angular
                        [img]="Star"
                        *ngFor="
                          let filled of getStarArray(
                            featuredBooks[0].ratingAverage
                          )
                        "
                        class="w-5 h-5"
                        [class.fill-current]="filled"
                      >
                      </lucide-angular>
                    </div>
                    <span
                      class="font-medium"
                      style="color: var(--color-text-heading)"
                    >
                      {{ featuredBooks[0].ratingAverage | number : "1.1-1" }}
                    </span>
                    <span style="color: var(--color-text-muted)">
                      ({{ featuredBooks[0].ratingQuantity }} reviews)
                    </span>
                  </div>
                  <div
                    class="text-3xl font-bold"
                    style="color: var(--color-brand-primary)"
                  >
                    {{ formatPrice(featuredBooks[0].price) }}
                  </div>
                </div>
                <p
                  class="text-lg leading-relaxed mb-8"
                  style="color: var(--color-text-muted)"
                >
                  {{ truncateDescription(featuredBooks[0].description, 150) }}
                </p>
                <button
                  [routerLink]="['/book-info', featuredBooks[0]._id]"
                  class="px-8 py-4 rounded-full font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg"
                  style="
                    background-color: var(--color-brand-primary);
                    color: var(--color-on-dark);
                  "
                >
                  <lucide-angular
                    [img]="ArrowRight"
                    class="inline w-5 h-5 ml-2"
                  ></lucide-angular>
                  Explore Book
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Books Grid - Mixed Layout -->
    <section class="py-20">
      <div class="container mx-auto px-4">
        <div class="max-w-7xl mx-auto">
          <!-- Top Rated Books Row -->
          <div *ngIf="topRatedBooks.length > 0" class="mb-20">
            <div class="flex justify-between items-end mb-12">
              <div>
                <h2
                  class="text-4xl font-bold mb-2"
                  style="
                    color: var(--color-text-heading);
                    font-family: var(--font-primary);
                  "
                >
                  Highly Rated
                </h2>
                <p class="text-lg" style="color: var(--color-text-muted)">
                  Books our readers love most
                </p>
              </div>
              <button
                [routerLink]="['/browse']"
                class="text-lg font-medium hover:underline transition-all"
                style="color: var(--color-brand-primary)"
              >
                View All
              </button>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-6 gap-6">
              <div
                *ngFor="let book of topRatedBooks; let i = index"
                [class]="i === 0 ? 'md:col-span-2 md:row-span-2' : ''"
                class="group cursor-pointer book-card-minimal"
                [routerLink]="['/book-info', book._id]"
              >
                <!-- Large card for first book -->
                <div *ngIf="i === 0" class="space-y-4">
                  <div
                    class="aspect-[3/4] overflow-hidden rounded-2xl shadow-lg"
                  >
                    <img
                      [src]="book.image"
                      [alt]="book.title"
                      class="w-full h-full object-cover transform transition-all duration-500 group-hover:scale-105"
                    />
                  </div>
                  <div class="space-y-2">
                    <h3
                      class="font-bold text-xl leading-tight line-clamp-2"
                      style="color: var(--color-text-heading)"
                    >
                      {{ book.title }}
                    </h3>
                    <p class="text-base" style="color: var(--color-text-muted)">
                      {{ book.authorName }}
                    </p>
                    <div class="flex items-center justify-between">
                      <div class="flex items-center gap-1">
                        <lucide-angular
                          [img]="Star"
                          class="w-4 h-4 fill-current"
                          style="color: #fbbf24"
                        ></lucide-angular>
                        <span
                          class="font-medium"
                          style="color: var(--color-text-heading)"
                        >
                          {{ book.ratingAverage | number : "1.1-1" }}
                        </span>
                      </div>
                      <span
                        class="font-bold text-lg"
                        style="color: var(--color-brand-primary)"
                      >
                        {{ formatPrice(book.price) }}
                      </span>
                    </div>
                  </div>
                </div>

                <!-- Small cards for other books -->
                <div *ngIf="i > 0" class="space-y-3">
                  <div
                    class="aspect-[3/4] overflow-hidden rounded-xl shadow-md"
                  >
                    <img
                      [src]="book.image"
                      [alt]="book.title"
                      class="w-full h-full object-cover transform transition-all duration-500 group-hover:scale-105"
                    />
                  </div>
                  <div class="space-y-1">
                    <h3
                      class="font-semibold text-sm leading-tight line-clamp-2"
                      style="color: var(--color-text-heading)"
                    >
                      {{ book.title }}
                    </h3>
                    <p class="text-xs" style="color: var(--color-text-muted)">
                      {{ book.authorName }}
                    </p>
                    <div class="flex items-center justify-between text-xs">
                      <div class="flex items-center gap-1">
                        <lucide-angular
                          [img]="Star"
                          class="w-3 h-3 fill-current"
                          style="color: #fbbf24"
                        ></lucide-angular>
                        <span style="color: var(--color-text-muted)">{{
                          book.ratingAverage | number : "1.1-1"
                        }}</span>
                      </div>
                      <span
                        class="font-bold"
                        style="color: var(--color-brand-primary)"
                      >
                        {{ formatPrice(book.price) }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Recent Books Row -->
          <div *ngIf="recentBooks.length > 0" class="mb-20">
            <div class="flex justify-between items-end mb-12">
              <div>
                <h2
                  class="text-4xl font-bold mb-2"
                  style="
                    color: var(--color-text-heading);
                    font-family: var(--font-primary);
                  "
                >
                  New Arrivals
                </h2>
                <p class="text-lg" style="color: var(--color-text-muted)">
                  Fresh additions to our collection
                </p>
              </div>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
              <div
                *ngFor="let book of recentBooks"
                class="group cursor-pointer flex gap-6 p-6 rounded-2xl transition-all duration-300 hover:shadow-lg"
                [routerLink]="['/book-info', book._id]"
                style="background-color: var(--color-background-medium)"
              >
                <div
                  class="w-34 h-42 flex-shrink-0 overflow-hidden rounded-lg shadow-md"
                >
                  <img
                    [src]="book.image"
                    [alt]="book.title"
                    class="w-full h-full object-cover transform transition-all duration-500 group-hover:scale-105"
                  />
                </div>

                <div class="flex-1 space-y-2">
                  <span
                    class="text-xs font-medium px-2 py-1 rounded-full"
                    style="
                      background-color: var(--color-brand-primary);
                      color: var(--color-on-dark);
                    "
                  >
                    NEW
                  </span>
                  <h3
                    class="font-bold text-lg leading-tight line-clamp-2"
                    style="color: var(--color-text-heading)"
                  >
                    {{ book.title }}
                  </h3>
                  <p class="text-sm" style="color: var(--color-text-muted)">
                    {{ book.authorName }}
                  </p>
                  <div class="flex items-center justify-between">
                    <div class="flex items-center gap-1">
                      <lucide-angular
                        [img]="Star"
                        class="w-4 h-4 fill-current"
                        style="color: #fbbf24"
                      ></lucide-angular>
                      <span
                        class="text-sm font-medium"
                        style="color: var(--color-text-heading)"
                      >
                        {{ book.ratingAverage | number : "1.1-1" }}
                      </span>
                    </div>
                    <span
                      class="font-bold text-lg"
                      style="color: var(--color-brand-primary)"
                    >
                      {{ formatPrice(book.price) }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Genre Sections - Horizontal Scroll -->
          <div *ngIf="getGenreKeys().length > 0">
            <div
              *ngFor="let genre of getGenreKeys(); let i = index"
              class="mb-16"
            >
              <div class="flex justify-between items-end mb-8">
                <div>
                  <h2
                    class="text-3xl font-bold mb-2"
                    style="
                      color: var(--color-text-heading);
                      font-family: var(--font-primary);
                    "
                  >
                    {{ genre }}
                  </h2>
                  <p style="color: var(--color-text-muted)">
                    Explore {{ genre.toLowerCase() }} books
                  </p>
                </div>
              </div>

              <div class="flex gap-8 overflow-x-auto pb-4 scrollbar-hide">
                <div
                  *ngFor="let book of genreBooks[genre]"
                  class="flex-shrink-0 w-56 group cursor-pointer"
                  [routerLink]="['/book-info', book._id]"
                >
                  <div
                    class="aspect-[3/4] overflow-hidden rounded-xl shadow-md mb-4"
                  >
                    <img
                      [src]="book.image"
                      [alt]="book.title"
                      class="w-full h-full object-cover transform transition-all duration-500 group-hover:scale-105"
                    />
                  </div>

                  <div class="space-y-2">
                    <h3
                      class="font-semibold text-lg leading-tight line-clamp-2"
                      style="color: var(--color-text-heading)"
                    >
                      {{ book.title }}
                    </h3>
                    <p class="text-base" style="color: var(--color-text-muted)">
                      {{ book.authorName }}
                    </p>
                    <div class="flex items-center justify-between">
                      <div class="flex items-center gap-1">
                        <lucide-angular
                          [img]="Star"
                          class="w-4 h-4 fill-current"
                          style="color: #fbbf24"
                        ></lucide-angular>
                        <span
                          class="text-sm font-medium"
                          style="color: var(--color-text-heading)"
                        >
                          {{ book.ratingAverage | number : "1.1-1" }}
                        </span>
                      </div>
                      <span
                        class="font-bold text-lg"
                        style="color: var(--color-brand-primary)"
                      >
                        {{ formatPrice(book.price) }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Simple CTA -->
    <section
      class="py-16 text-center"
      style="background-color: var(--color-background-medium)"
    >
      <div class="container mx-auto px-4">
        <h2
          class="text-3xl font-bold mb-4"
          style="
            color: var(--color-text-heading);
            font-family: var(--font-primary);
          "
        >
          Ready to discover your next great read?
        </h2>
        <p class="text-lg mb-8" style="color: var(--color-text-muted)">
          Browse our complete collection of carefully curated books
        </p>
        <button
          [routerLink]="['/browse']"
          class="px-8 py-4 rounded-full font-semibold text-lg transition-all duration-300 hover:shadow-lg"
          style="
            background-color: var(--color-brand-primary);
            color: var(--color-on-dark);
          "
        >
          <lucide-angular
            [img]="BookOpen"
            class="inline w-5 h-5 mr-2"
          ></lucide-angular>
          Browse All Books
        </button>
      </div>
    </section>
  </div>
</div>
