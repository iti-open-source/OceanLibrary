<nav
  class="sticky top-0 z-50 bg-[var(--color-background-light)] text-[var(--color-text-default)] shadow-lg border-b border-[var(--color-border)] font-secondary"
>
  <!-- Main navbar container -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">
      <!-- Logo/Brand -->
      <div class="flex-shrink-0">
        <a
          routerLink=""
          class="cursor-pointer font-brand text-2xl sm:text-3xl text-[var(--color-text-heading)] hover:opacity-80 transition-opacity"
          (click)="closeMobileMenu()"
          >oceanlibrary</a
        >
      </div>

      <!-- Desktop Search (hidden on mobile) -->
      <div class="hidden md:flex flex-1 max-w-2xl mx-6 lg:mx-8">
        <app-autocomplete-search
          placeholder="Search books by title or author..."
          [showCtrlKIndicator]="true"
          (searchSelected)="onSearchSelected($event)"
          (suggestionSelected)="onSuggestionSelected($event)"
          class="w-full"
        ></app-autocomplete-search>
      </div>

      <!-- Mobile menu button -->
      <div class="md:hidden">
        <button
          type="button"
          (click)="toggleMobileMenu()"
          class="relative inline-flex items-center justify-center rounded-md p-2 text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] hover:text-[var(--color-brand-primary)] focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[var(--color-brand-primary)] transition-colors duration-200"
          aria-expanded="false"
          [attr.aria-expanded]="mobileMenuOpen"
        >
          <span class="sr-only">Open main menu</span>
          <!-- Hamburger icon -->
          <lucide-icon
            [img]="mobileMenuOpen ? X : Menu"
            class="h-6 w-6"
            [class.rotate-180]="mobileMenuOpen"
            style="transition: transform 0.2s ease-in-out"
          ></lucide-icon>
        </button>
      </div>

      <!-- Desktop Navigation Links -->
      <div class="hidden md:flex items-center space-x-4 lg:space-x-6">
        <!-- Nav Icons -->
        <div class="flex items-center space-x-3 lg:space-x-5">
          <a
            routerLink=""
            [class]="getNavLinkClass('')"
            tabindex="0"
            (click)="closeMobileMenu()"
          >
            <lucide-icon
              [img]="Home"
              class="nav-icon h-5 w-5 lg:h-6 lg:w-6 mb-1"
            ></lucide-icon>
            <span class="nav-text text-xs hidden lg:block">Home</span>
          </a>
          <a
            routerLink="browse"
            [class]="getNavLinkClass('browse')"
            tabindex="0"
            (click)="closeMobileMenu()"
          >
            <lucide-icon
              [img]="Compass"
              class="nav-icon h-5 w-5 lg:h-6 lg:w-6 mb-1"
            ></lucide-icon>
            <span class="nav-text text-xs hidden lg:block">Browse</span>
          </a>
          <a
            routerLink="cart"
            [class]="getNavLinkClass('cart')"
            tabindex="0"
            (click)="closeMobileMenu()"
          >
            <lucide-icon
              [img]="ShoppingCart"
              class="nav-icon h-5 w-5 lg:h-6 lg:w-6 mb-1"
            ></lucide-icon>
            <span class="nav-text text-xs hidden lg:block">Cart</span>
          </a>
          <a
            routerLink="admin"
            [class]="getNavLinkClass('admin')"
            tabindex="0"
            (click)="closeMobileMenu()"
            *ngIf="isAdmin"
          >
            <lucide-icon
              [img]="Settings"
              class="nav-icon h-5 w-5 lg:h-6 lg:w-6 mb-1"
            ></lucide-icon>
            <span class="nav-text text-xs hidden lg:block">Admin</span>
          </a>
        </div>

        <!-- Auth Section -->
        <div class="flex items-center gap-2 lg:gap-3 ml-4" *ngIf="!isLoggedIn">
          <a
            routerLink="/login"
            class="px-3 py-2 lg:px-4 lg:py-2 rounded-lg font-semibold text-sm text-[var(--color-text-default)] bg-[var(--color-background-light)] border border-[var(--color-border)] hover:bg-[var(--color-background-medium)] hover:border-[var(--color-brand-primary)] transition-all duration-200 shadow-sm"
            (click)="closeMobileMenu()"
          >
            Login
          </a>
          <a
            routerLink="/register"
            class="px-3 py-2 lg:px-4 lg:py-2 rounded-lg font-semibold text-sm bg-[var(--color-background-dark)] text-[var(--color-text-default)] hover:bg-[var(--color-border)] hover:shadow-md transition-all duration-200 shadow-sm"
            (click)="closeMobileMenu()"
          >
            Register
          </a>
        </div>

        <!-- Profile Menu -->
        <div class="relative group ml-4" tabindex="0" *ngIf="isLoggedIn">
          <button
            type="button"
            (click)="profileMenuOpen = !profileMenuOpen"
            class="nav-link cursor-pointer"
          >
            <span class="flex items-center">
              <img
                class="h-8 w-8 lg:h-9 lg:w-9 rounded-full object-cover border-2 border-transparent group-hover:border-[var(--color-brand-primary)] transition cursor-pointer"
                src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=100&q=80"
                alt="profile image"
              />
              <lucide-icon
                [img]="ChevronDown"
                class="ml-2 h-4 w-4 lg:h-5 lg:w-5 text-[var(--color-text-muted)]"
              ></lucide-icon>
            </span>
          </button>
          <div
            *ngIf="profileMenuOpen"
            class="absolute right-0 mt-3 w-44 bg-[var(--color-background-light)] border border-[var(--color-border)] rounded-xl shadow-xl z-30 animate-fade-in"
          >
            <div class="flex justify-end pr-4 -mt-2">
              <span
                class="block w-3 h-3 rotate-45 bg-[var(--color-background-light)] border-t border-l border-[var(--color-border)] -mb-1"
              ></span>
            </div>
            <a
              routerLink="/profile"
              class="cursor-pointer flex items-center px-5 py-3 text-sm text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] rounded-t-xl"
              (click)="profileMenuOpen = false; closeMobileMenu()"
            >
              <lucide-icon [img]="User" class="mr-2 h-5 w-5"></lucide-icon>
              Profile
            </a>
            <a
              routerLink="/orders"
              class="cursor-pointer flex items-center px-5 py-3 text-sm text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)]"
              (click)="navigateToOrders()"
            >
              <lucide-icon [img]="Package" class="mr-2 h-5 w-5"></lucide-icon>
              Orders
            </a>
            <button
              type="button"
              class="w-full text-left cursor-pointer flex items-center px-5 py-3 text-sm text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] rounded-b-xl bg-transparent border-0 outline-none"
              (click)="signOut(); profileMenuOpen = false"
            >
              <lucide-icon [img]="LogOut" class="mr-2 h-5 w-5"></lucide-icon>
              Sign Out
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile menu overlay and content -->
  <div
    *ngIf="mobileMenuOpen"
    class="md:hidden fixed top-16 inset-x-0 bottom-0 z-40 bg-black bg-opacity-50 backdrop-blur-sm animate-fade-in"
    (click)="closeMobileMenu()"
  ></div>

  <!-- Mobile menu panel -->
  <div
    *ngIf="mobileMenuOpen"
    class="md:hidden absolute top-16 left-0 right-0 z-50 bg-[var(--color-background-light)] border-b border-[var(--color-border)] shadow-xl animate-slide-down"
  >
    <div class="px-4 py-6 space-y-6">
      <!-- Mobile Search -->
      <div class="px-2">
        <app-autocomplete-search
          placeholder="Search books by title or author..."
          [showCtrlKIndicator]="false"
          (searchSelected)="onSearchSelected($event)"
          (suggestionSelected)="onSuggestionSelected($event)"
          class="w-full"
        ></app-autocomplete-search>
      </div>

      <!-- Mobile Navigation Links -->
      <div class="space-y-4 px-2">
        <a
          routerLink=""
          [class]="getMobileNavLinkClass('')"
          (click)="closeMobileMenu()"
        >
          <lucide-icon [img]="Home" class="h-6 w-6 mr-3"></lucide-icon>
          <span class="text-lg font-medium">Home</span>
        </a>
        <a
          routerLink="browse"
          [class]="getMobileNavLinkClass('browse')"
          (click)="closeMobileMenu()"
        >
          <lucide-icon [img]="Compass" class="h-6 w-6 mr-3"></lucide-icon>
          <span class="text-lg font-medium">Browse</span>
        </a>
        <a
          routerLink="cart"
          [class]="getMobileNavLinkClass('cart')"
          (click)="closeMobileMenu()"
        >
          <lucide-icon [img]="ShoppingCart" class="h-6 w-6 mr-3"></lucide-icon>
          <span class="text-lg font-medium">Cart</span>
        </a>
        <a
          routerLink="admin"
          [class]="getMobileNavLinkClass('admin')"
          (click)="closeMobileMenu()"
          *ngIf="isAdmin"
        >
          <lucide-icon [img]="Settings" class="h-6 w-6 mr-3"></lucide-icon>
          <span class="text-lg font-medium">Admin Panel</span>
        </a>
      </div>

      <!-- Mobile Auth Section or Profile -->
      <div class="border-t border-[var(--color-border)] pt-6 px-2">
        <div *ngIf="!isLoggedIn" class="space-y-3">
          <a
            routerLink="/login"
            class="w-full flex items-center justify-center px-4 py-3 rounded-lg font-semibold text-lg text-[var(--color-text-default)] bg-[var(--color-background-light)] border-2 border-[var(--color-border)] hover:bg-[var(--color-background-medium)] hover:border-[var(--color-brand-primary)] transition-all duration-200 shadow-sm"
            (click)="closeMobileMenu()"
          >
            <lucide-icon [img]="LogIn" class="h-5 w-5 mr-2"></lucide-icon>
            Login
          </a>
          <a
            routerLink="/register"
            class="w-full flex items-center justify-center px-4 py-3 rounded-lg font-semibold text-lg bg-[var(--color-background-dark)] text-[var(--color-text-default)] hover:bg-[var(--color-border)] hover:shadow-md transition-all duration-200 shadow-sm"
            (click)="closeMobileMenu()"
          >
            <lucide-icon [img]="UserPlus" class="h-5 w-5 mr-2"></lucide-icon>
            Register
          </a>
        </div>

        <div *ngIf="isLoggedIn" class="space-y-3">
          <a
            routerLink="/profile"
            class="w-full flex items-center px-4 py-3 rounded-lg text-lg text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] transition-colors duration-200"
            (click)="closeMobileMenu()"
          >
            <img
              class="h-8 w-8 rounded-full object-cover border-2 border-[var(--color-border)] mr-3"
              src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=100&q=80"
              alt="profile image"
            />
            <span class="font-medium">Profile</span>
          </a>
          <a
            routerLink="/orders"
            class="w-full flex items-center px-4 py-3 rounded-lg text-lg text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] transition-colors duration-200"
            (click)="navigateToOrders()"
          >
            <lucide-icon [img]="Package" class="h-6 w-6 mr-3"></lucide-icon>
            <span class="font-medium">Orders</span>
          </a>
          <button
            type="button"
            class="w-full flex items-center px-4 py-3 rounded-lg text-lg text-[var(--color-text-default)] hover:bg-[var(--color-background-medium)] transition-colors duration-200 bg-transparent border-0 outline-none"
            (click)="signOut()"
          >
            <lucide-icon [img]="LogOut" class="h-6 w-6 mr-3"></lucide-icon>
            <span class="font-medium">Sign Out</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>
